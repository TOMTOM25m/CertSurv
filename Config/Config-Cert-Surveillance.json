{
  "ScriptVersion": "v1.1.0",
  "RulebookVersion": "v9.3.1",
  "Version": "v1.1.0",
  "ConfigurationUpdated": "2025-09-04T15:30:00Z",
  "ConfigurationNotes": "Enhanced with decentralized WebService support for parallel multi-server certificate collection",
  "RunMode": "PROD",
  "Language": "de-DE",
  "DebugMode": false,
  "LastModuleCheck": "",
  "MainDomain": "meduniwien.ac.at",
  "Paths": {
    "ConfigFile": "F:\\DEV\\repositories\\CertSurv\\Config\\Config-Cert-Surveillance.json",
    "PathTo7Zip": "C:\\Program Files\\7-Zip\\7z.exe",
    "LogoDirectory": "\\\\itscmgmt03.srv.meduniwien.ac.at\\iso\\MUWLogo",
    "ReportDirectory": "reports",
    "LogDirectory": "LOG",
    "JsonDataDirectory": "LOG",
    "JsonDataRetentionDays": 90
  },
  "Excel": {
    "ExcelPath": "\\\\itscmgmt03.srv.meduniwien.ac.at\\iso\\WIndowsServerListe\\Serverliste2025FQDN.xlsx",
    "SheetName": "Serverliste2025",
    "HeaderRow": 2,
    "FqdnColumnName": "FQDN",
    "ServerNameColumnName": "ServerName",
    "DomainStatusColumnName": "OS_Name",
    "AlwaysUseConfigPath": true
  },
  "Network": {
    "DnsServer": "149.148.55.55",
    "TlsVersion": "SystemDefault"
  },
  "Certificate": {
    "Port": 443,
    "WarningDays": 30,
    "Timeout": 10000,
    "RetryAttempts": 3,
    "Method": "Socket",
    "EnableBrowserCheck": true,
    "EnableComparison": true,
    "EnableAutoPortDetection": true,
    "TestMode": {
      "Enabled": false,
      "AllowedDomains": ["UVW", "WORKGROUP", "EX"],
      "AllowedServers": ["EX01"],
      "MaxServers": 1
    },
    "WebService": {
      "Enabled": true,
      "Mode": "Decentralized",
      "PrimaryServer": "itscmgmt03.srv.meduniwien.ac.at",
      "HttpPort": 9080,
      "HttpsPort": 9443,
      "UseHttps": false,
      "FallbackToLocal": true,
      "Timeout": 5000,
      "MaxRetries": 2,
      "CacheEnabled": true,
      "ParallelProcessing": {
        "Enabled": true,
        "MaxConcurrent": 20,
        "BatchSize": 10,
        "EnableProgressDisplay": true
      },
      "Authentication": {
        "Method": "Windows",
        "UseDefaultCredentials": true,
        "RequireAuthentication": false
      },
      "HealthCheck": {
        "Enabled": true,
        "TimeoutSeconds": 3,
        "RetryCount": 1
      },
      "Endpoints": {
        "Certificates": "/certificates.json",
        "Summary": "/summary.json",
        "Health": "/health.json"
      },
      "Deployment": {
        "DeployToAllServers": true,
        "StandardPorts": [9080, 9443],
        "ConfigurationTemplate": "CertWebService-Template.json",
        "AutoUpdate": false,
        "MonitoringEnabled": true
      }
    },
    "CommonSSLPorts": [
      443,
      9443,
      8443,
      4443,
      10443,
      8080,
      8081
    ],
    "UserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) Certificate-Surveillance/1.0",
    "EnableSslProtocols": [
      "Tls12",
      "Tls13"
    ],
    "ReportPath": "Reports\\Certificate-Reports"
  },
  "Intervals": {
    "DaysUntilUrgent": 10,
    "DaysUntilCritical": 30,
    "DaysUntilWarning": 60,
    "ArchiveLogsOlderThanDays": 30,
    "DeleteZipArchivesOlderThanDays": 90
  },
  "Mail": {
    "Enabled": true,
    "SmtpServer": "smtpi.meduniwien.ac.at",
    "SmtpPort": 25,
    "UseSsl": false,
    "SenderAddress": "ITSCMGMT03@meduniwien.ac.at",
    "DevTo": "thomas.garnreiter@meduniwien.ac.at",
    "ProdTo": "win-admin@meduniwien.ac.at",
    "SubjectPrefix": "[Zertifikats-Report]",
    "CredentialFilePath": "C:\\Script\\Zertifikate\\Config\\secure.smtp.cred.xml",
    "DailyReport": {
      "Enabled": true,
      "ScheduledTime": "06:00",
      "TimeWindowMinutes": 30,
      "IncludeStatuses": ["Expired", "Urgent", "Critical", "Warning"],
      "SuppressIfNoIssues": false,
      "MaxCertificatesInEmail": 100
    }
  },
  "CorporateDesign": {
    "PrimaryColor": "#111d4e",
    "HoverColor": "#5fb4e5"
  }
}
